{
  "hash": "34841297f30e64f7bad59d508e8c9bf7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Analysis of driving factors of the 2024 Global Happiness Index\"\nauthor: \"Jintao\"\ndate: \"2024-12-10\"\ncategories: [news, code, analysis]\nimage: \"image/happiness.jpg\"\n---\n\n\nResearch objectives :\n\n-   Visualize the regional distribution of happiness index of each country.\n\n-   Explore the impact of GDP, social support, and healthy life expectancy on happiness index.\n\n-   Use multiple linear regression model to evaluate the main influencing factors.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load necessary libraries\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(conflicted)\nlibrary(sf)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: 程序包'sf'是用R版本4.4.2 来建造的\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLinking to GEOS 3.12.2, GDAL 3.9.3, PROJ 9.4.1; sf_use_s2() is TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(rnaturalearth)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: 程序包'rnaturalearth'是用R版本4.4.2 来建造的\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(rnaturalearthdata)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: 程序包'rnaturalearthdata'是用R版本4.4.2 来建造的\n```\n\n\n:::\n\n```{.r .cell-code}\nconflict_prefer(\"filter\", \"dplyr\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n[conflicted] Will prefer dplyr::filter over any other package.\n```\n\n\n:::\n\n```{.r .cell-code}\nconflict_prefer(\"lag\", \"dplyr\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n[conflicted] Will prefer dplyr::lag over any other package.\n```\n\n\n:::\n:::\n\n\nData source:\n\nThe dataset comes from: [Kaggle - World Happiness Report 2024](https://www.kaggle.com/datasets/jainaru/world-happiness-report-2024-yearly-updated/data)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load data\nhappiness_data <- read.csv(\"data/World-happiness-report-2024.csv\")\n\n# Show data structure\nstr(happiness_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t143 obs. of  12 variables:\n $ Country.name                : chr  \"Finland\" \"Denmark\" \"Iceland\" \"Sweden\" ...\n $ Regional.indicator          : chr  \"Western Europe\" \"Western Europe\" \"Western Europe\" \"Western Europe\" ...\n $ Ladder.score                : num  7.74 7.58 7.53 7.34 7.34 ...\n $ upperwhisker                : num  7.82 7.66 7.62 7.42 7.41 ...\n $ lowerwhisker                : num  7.67 7.5 7.43 7.27 7.28 ...\n $ Log.GDP.per.capita          : num  1.84 1.91 1.88 1.88 1.8 ...\n $ Social.support              : num  1.57 1.52 1.62 1.5 1.51 ...\n $ Healthy.life.expectancy     : num  0.695 0.699 0.718 0.724 0.74 0.706 0.704 0.708 0.747 0.692 ...\n $ Freedom.to.make.life.choices: num  0.859 0.823 0.819 0.838 0.641 0.725 0.835 0.801 0.759 0.756 ...\n $ Generosity                  : num  0.142 0.204 0.258 0.221 0.153 0.247 0.224 0.146 0.173 0.225 ...\n $ Perceptions.of.corruption   : num  0.546 0.548 0.182 0.524 0.193 0.372 0.484 0.432 0.498 0.323 ...\n $ Dystopia.residual           : num  2.08 1.88 2.05 1.66 2.3 ...\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Data cleaning: Select relevant variables and check for missing values\nhappiness_clean <- happiness_data %>%\n  select(Country.name, Regional.indicator, Ladder.score, Log.GDP.per.capita, Social.support, Healthy.life.expectancy,Freedom.to.make.life.choices, Generosity, Perceptions.of.corruption,Dystopia.residual) %>%\n  drop_na() %>%\n  rename(\n    Country = Country.name,                \n    Region = Regional.indicator,                  \n    Happiness_Score = Ladder.score, \n    GDP_Per_Capita = Log.GDP.per.capita,  \n    Social_Support = Social.support,   \n    Life_Expectancy = Healthy.life.expectancy,\n    Freedom = Freedom.to.make.life.choices,\n    Generosity = Generosity,\n    Perceptions = Perceptions.of.corruption,\n    Dystopia = Dystopia.residual\n  )\n```\n:::\n\n\nVisualizing the global distribution of happiness index\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Mapping the regional distribution of happiness index\nhappiness_clean %>%\n  group_by(Region) %>%\n  summarise(Average_Score = mean(Happiness_Score)) %>%\n  ggplot(aes(x = reorder(Region, -Average_Score), y = Average_Score, fill = Region)) +\n  geom_bar(stat = \"identity\") +\n  coord_flip() +\n  labs(title = \"Average happiness index of different regions in the world\",\n       x = \"area\",\n       y = \"Average happiness index\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nIn terms of regional distribution, the average happiness index in Northern Europe is the highest, while the happiness index in Sub-Saharan Africa is the lowest.\n\n--\n\nCorrelation between the analysis index and happiness scores\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Remove the column named \"Country\" and \"Region\"\nhappiness_clean_new <- happiness_clean %>%\n  select(-Country, -Region)\n\n# Calculate the correlation matrix\ncorrelation_matrix <- cor(happiness_clean_new, use = \"complete.obs\")\n\n# Calculate the correlation matrix\ncorrelation_with_happiness <- correlation_matrix[\"Happiness_Score\", ]\ncorrelation_with_happiness\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nHappiness_Score  GDP_Per_Capita  Social_Support Life_Expectancy         Freedom \n      1.0000000       0.7685037       0.8135420       0.7596594       0.6444511 \n     Generosity     Perceptions        Dystopia \n      0.1300382       0.4518290       0.5335424 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Convert to data frame\ncorrelations <- as.data.frame(correlation_with_happiness) %>%\n  rownames_to_column(\"Parameter\") %>%\n  rename(Correlation = \"correlation_with_happiness\") %>%\n  filter(Parameter != \"Ladder.score\")  # 排除自身\n\n# Plot a correlation bar chart\nggplot(correlations, aes(x = reorder(Parameter, Correlation), y = Correlation, fill = Correlation)) +\n  geom_bar(stat = \"identity\") +\n  coord_flip() +\n  labs(title = \"Correlation analysis of parameters with happiness index\",\n       x = \"parameter\",\n       y = \"Correlation\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nResult analysis\n\nParameters with strong correlation:\n\n-   GDP.per.capita\n\n-   Social.support\n\n-   Healthy.life.expectancy\n\n--\n\nFocus on analyzing the impact of these three indicators on the happiness index\n\nMultiple regression analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Building a multiple linear regression model\nmodel <- lm(Happiness_Score ~ GDP_Per_Capita + Social_Support + Life_Expectancy, \n            data = happiness_clean)\n\n# Model Summary\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Happiness_Score ~ GDP_Per_Capita + Social_Support + \n    Life_Expectancy, data = happiness_clean)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.91136 -0.31085  0.01014  0.40511  1.26989 \n\nCoefficients:\n                Estimate Std. Error t value Pr(>|t|)    \n(Intercept)       1.8552     0.1922   9.655  < 2e-16 ***\nGDP_Per_Capita    0.6186     0.2316   2.671  0.00849 ** \nSocial_Support    1.7383     0.2328   7.467 8.91e-12 ***\nLife_Expectancy   1.6336     0.5798   2.818  0.00556 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.6049 on 136 degrees of freedom\nMultiple R-squared:  0.7434,\tAdjusted R-squared:  0.7377 \nF-statistic: 131.3 on 3 and 136 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\nImportance Analysis and Visualization\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Extract regression coefficients\nimportance <- summary(model)$coefficients %>%\n  as.data.frame() %>%\n  rownames_to_column(\"Feature\") %>%\n  filter(Feature != \"(Intercept)\")\n\n# Plot feature importance\nggplot(importance, aes(x = reorder(Feature, Estimate), y = Estimate)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\") +\n  coord_flip() +\n  labs(title = \"Key factors affecting happiness index\",\n       x = \"Influencing factors\",\n       y = \"Regression coefficient\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot GDP against happiness index\nggplot(happiness_clean, aes(x = GDP_Per_Capita , y = Happiness_Score )) +\n  geom_point(aes(color = Region), alpha = 0.7) +\n  geom_smooth(method = \"lm\", color = \"blue\") +\n  labs(title = \"The relationship between GDP and happiness index\",\n       x = \"GDP\",\n       y = \"Happiness Index\") +\n  theme_minimal()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Plot the relationship between Social_Support and happiness index\nggplot(happiness_clean, aes(x = Social_Support , y = Happiness_Score )) +\n  geom_point(color = \"blue\", alpha = 0.6) + \n  geom_smooth(method = \"lm\", color = \"red\", linetype = \"dashed\") + \n  labs(\n    title = \"The relationship between social support and happiness index\",\n    x = \"Social Support\",\n    y = \"Happiness Score\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Plot Life_Expectancy vs. Happiness Index\nggplot(happiness_clean, aes(x = Life_Expectancy, y = Happiness_Score)) +\n  geom_point(color = \"green\", alpha = 0.6) + \n  geom_smooth(method = \"lm\", color = \"red\", linetype = \"dashed\") + \n  labs(\n    title = \"The relationship between life expectancy and happiness index\",\n    x = \"Life Expectancy (Healthy)\",\n    y = \"Happiness Score\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-3.png){width=672}\n:::\n:::\n\n\nConclusion:\n\nCountries with higher GDP generally have higher happiness indexes, but in some cases there may be diminishing marginal effects (i.e., the improvement in happiness index becomes smaller as GDP increases to a certain level).Developed regions (such as Northern Europe) may exhibit high GDP and high happiness index. Developing regions may show lower GDP and happiness indices. While GDP is an important factor in happiness, non-economic indicators (e.g. social support, healthy life expectancy) may contribute even more to the happiness index.\n\nHigh social support (such as having more support from family and friends) significantly increases happiness index. The role of social support may be related to cultural and economic conditions, such as: Nordic countries generally have high social support and high happiness scores. Economically underdeveloped areas may have lower social support and lower happiness indexes.\n\nHealthy life expectancy (Life_Expectancy) is an important determinant of happiness index. Good health and longevity are important sources of happiness. In some developed countries, healthy life expectancy is higher and the happiness index is also high (such as Europe and North America). For countries with low healthy life expectancy (such as some developing countries), happiness may be affected by inadequate medical care and quality of life.\n\nGovernments and institutions can focus on improving public health and social support systems to increase overall well-being.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}